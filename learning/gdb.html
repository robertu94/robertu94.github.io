<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Learning to Learn: GDB | systems++</title>
<meta name=keywords content="Learning to Learn,Programming,C++,GDB">
<meta name=description content="GDB is a powerful tool that is underutilized by most programmers that I&rsquo;ve met. It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process. It is an invaluable tool for understanding what is going wrong with your programs.
How to get started To get the most out of GDB you need to compile your program with debug information &ndash; metadata that describes the program source.">
<meta name=author content="Robert Underwood">
<link rel=canonical href=http://robertu94.github.io/learning/gdb.html>
<meta name=google-site-verification content="G-9KQE44SX6K">
<link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.baa4f2053c75d0009e9309aae8f8a8959f5e0372e88f80cdf2951a9533d71ce2.js integrity="sha256-uqTyBTx10ACekwmq6PiolZ9eA3Loj4DN8pUalTPXHOI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://robertu94.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=http://robertu94.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=http://robertu94.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=http://robertu94.github.io/apple-touch-icon.png>
<link rel=mask-icon href=http://robertu94.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9KQE44SX6K"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-9KQE44SX6K',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Learning to Learn: GDB">
<meta property="og:description" content="GDB is a powerful tool that is underutilized by most programmers that I&rsquo;ve met. It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process. It is an invaluable tool for understanding what is going wrong with your programs.
How to get started To get the most out of GDB you need to compile your program with debug information &ndash; metadata that describes the program source.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://robertu94.github.io/learning/gdb.html"><meta property="article:section" content="learning">
<meta property="og:site_name" content="Systems++">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Learning to Learn: GDB">
<meta name=twitter:description content="GDB is a powerful tool that is underutilized by most programmers that I&rsquo;ve met. It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process. It is an invaluable tool for understanding what is going wrong with your programs.
How to get started To get the most out of GDB you need to compile your program with debug information &ndash; metadata that describes the program source.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Learning to Learn: GDB","item":"http://robertu94.github.io/learning/gdb.html"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Learning to Learn: GDB","name":"Learning to Learn: GDB","description":"GDB is a powerful tool that is underutilized by most programmers that I\u0026rsquo;ve met. It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process. It is an invaluable tool for understanding what is going wrong with your programs.\nHow to get started To get the most out of GDB you need to compile your program with debug information \u0026ndash; metadata that describes the program source.","keywords":["Learning to Learn","Programming","C++","GDB"],"articleBody":"GDB is a powerful tool that is underutilized by most programmers that I’ve met. It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process. It is an invaluable tool for understanding what is going wrong with your programs.\nHow to get started To get the most out of GDB you need to compile your program with debug information – metadata that describes the program source. If writing proprietary software, be careful who gets access to debug builds of your software, it embeds the entire source code of your application into the debugging information.\nIf using gcc or clang, you can get debugging information by simply adding -g to the compilation flags and recompiling. If using CMake, you can enable debugging information by using either CMAKE_BUILD_TYPE=Debug or CMAKE_BUILD_TYPE=RelWithDebInfo – similar options exist for other buildsystems and compilers.\nOnce you have a debug build you can run your program as gdb --args ./path/to/program example arguments. When the program crashes, type bt at the prompt, and you will get a trace of the stack at the time the program crashed, you can then type info locals to get a printout of all the local variables, and you can then type dis to see the assembely where the program crashed. If this was all GDB did it would be enormously helpful.\nCore functionality Here is some of the most valuable capabilities provided by GDB:\nPrinting local variables you can print a local variable by calling p variablename. You can also print simple expressions such as p var1+var2 or p some_func(var1). You can print an array a like so p a[0]@length. C++ objects in the standard library have pretty printers so you get sane output for things like std::vector by calling p v.\nBreakpoints allow you stop execution of a program at a certain location. You can call break some_func to break on a function name and complete names with tab. For C++ which includes function overloads, you can break on specific template and overloads by tabbing out the specific implementation. You can also break at file locations break foo.cc:30. You can run until a breakpoint is hit by running continue or run to start for the first time. Breakpoints can also be conditional on boolean expressions break foo.cc:30 if a==3 to break at line 30 of file foo.cc if and only if a is 3. Lastly, you can break at an individual instruction which is powerful when you don’t have symbols\nYou can also break on C++ exceptions with catch throw and C signals with catch signal.\nRunning commands at breakpoints After defining a breakpoint, you can provide a set of commands that will run after the breakpoint is hit. For example:\nbreak foo.cc:30 commands print a contine end Would print a and then continue automatically.\nWatch points in addition to breaking on a function location, you can also break when a variable is modified. When this has hardware support it is reasonably fast, but only supports a small number of bytes. You can watch expressions such as watch left.\nIterative debugging (make) GDB allows you run make followed by run to rebuild and re-run. If you use cmake you can run !cmake --build builddir -j 8 to run builds too.\nStepping, navigating the stack GDB also allows you to single step and move up and down the stack with commands like s step into a function call, n go to the next program line, ni go to the next instruction, up go up the stack, down go down the stack, and fin to run until a function returns. However, these functions exist to supplement the functions described above instead of the primary means of using GDB.\nExamining Memory Printing raw memory GDB allows you to print raw memory using commands like `x/8xg to print the next 64 bytes as hex. This can be useful to debug when something was overwritten or to debug without debug symbols.\nSource and where to find it Types of debuginfo there are many kinds of debug info. On linux systems, the most common kind is dwarf (what you get with -g). Dwarf verbosity can be increased with GCC by using -g3 which includes for example macro definitions in the source code.\nStripping in addition to compiling with debug info the strip command allow removing this after the fact, this allows you to produce debug information and then re attach it later without having to ship it with every copy of the binary.\nSource directory (re-pathed) if you still have the source directory arround, you can tell GDB where to find it if it doesn’t automatically. You can provide it with symbol-file and if the path needs to be re-written, you can use set substitute-path to provide rules to re-write file paths in symbol files.\nDebuginfod linux distributions such as Fedora and CentOS now provide debuginfod servers which provide debug symbols for system libraries. This can provide symbols when they aren’t installed by default.\nSpack By default, spack compiles cmake projects with RelWithDebInfo which provides basic debugging symbols, however the source is not installed by default. By using spack envionments and spack develop it does the right thing, and you can get the source.\nDebugging Libraries Listing what shared libraries are loaded sometimes you want to know what libraries where loaded. info sharedlibrary to get a list of them. I used this to detect a version mismatch between uses of two different zfp libraries that were both installed.\nMulti Process/Thread GDB provides abilities to debug multi-process and multi-thread programs as well as those that call exec. The follow-fork and follow-exec commands do what you would expect. You can use catch fork and catch exec to break on fork and exec.\nNon-stop mode and background commands** allows non-main threads to continue to run when the focused thread is stopped. This is essential in many cases for debugging multi-threaded programs. To debug multiple threads simultaneously you will often need to run commands in the background by appending the \u0026 character to them. You can re-forground a thread by usingthe interrupt command\nAdvanced ways to start GDB In addition to starting a command under gdb, there are two other key ways to use GDB – core dumps and attaching to running processes.\nCore dumps What is a core dump Core dumps are a copy of all registers and memory. These can be taken at any time, but are created automatically when a signal such as sigsegv terminates a process.\nEnabling core dumps if they are not enabled, there are a few key steps to enable them: If you are using systemd, you can use coredumpctl gdb if you are a member of the journald group. If you are not a member of journald, and your system uses systemd, you don’t really have a way to enable core dumps without root privileges. If you are not using systemd, the core gets written to the location specified by kernel.core_pattern sysctl. Lastly, the process has to have a positive core dump limit which are defaulted by /etc/security/limits.conf\nUsing core dumps once you have a core file, you can debug a core file with gdb -c ./path/to/core ./path/to/program You can’t use breakpoints, but you can inspect local variables and final stack information.\nConnecting to a running process Connecting GDB to a running process require privileges – namely CAP_SYS_PTRACE or CAP_SYS_ADMIN – to attach to a process. You also will need permissions (e.g., user or gropus) to access the running process. You can connect to a running process with gdb -p $PID /path/to/command.\nGDB Server Beyond basic uses of GDB to connect to remote processes, GDB can also attach to remote processes or embeded devices. I’ve written a program called mpigdb that uses this functionality to debug MPI programs. To use this functionality start the program under gdbserver with a connection string and other flags you would otherwise pass to gdb. Once the GDB server is started, you can connect to a GDB server with target remote.\nThis functionality is also used for embedded devices. Lastly, GDB server functionality is also used with Valgrind’s interactive memory sanitizer to get much more information about memory leaks at runtime.\nOther Advanced Features GDB has many more advanced features, and only so many of them can be covered here. Here are a few more of the ones that I find very useful\nGDB Scripting Beyond just running commands at breakpoints, you can put a set of commands in to a file to be executed when GDB starts by passing -x ./path-to-script.gdb.\nSettings you’ll want to adjust To write effective scripts there are a few settings you will want to adjust:\n safe mode – what directories GDB can load scripts from pagination – GDB pauses when pagniation happens so using it scripts often requires turning this off. fork/exec/non-stop modes – set the fork and exec modes you need to be appropriate for your application  Setting variables often when writing scripts requires needing variables. GDB allows what are called convenience variables – variables which are not stored in the program’s memory. These variables are prefixed with a $ character and set with the set command.\nPython Extensions If GDB scripts in it’s scripting language are too primitive, you can also write extension commands and pretty printers in Python. These are simple python classes that have access to most of the capabilities of GDB.\nThese functionalities have been used for capabilities like debugging Python modules with C extensions. For example when running a python program (assuming everything has been configured correctly), you can call py-bt to get the python strack trace in addition to the C/C++ backtrack allowing you to vastly improve your ability to debug things.\nWhere to learn more? I’ve just scratched the surface. There are many more powerful features that I haven’t discussed such as reverse debugging, trace points, and more.\nFor more information see the GDB documentation\nI hope this helps!\nChangelog  2023-01-25 Created this document.  ","wordCount":"1670","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Robert Underwood"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://robertu94.github.io/learning/gdb.html"},"publisher":{"@type":"Organization","name":"systems++","logo":{"@type":"ImageObject","url":"http://robertu94.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=http://robertu94.github.io/ accesskey=h title="systems++ (Alt + H)">systems++</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=http://robertu94.github.io/about.html title="About Me">
<span>About Me</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/guides.html title=Guides>
<span>Guides</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/learning.html title="Learning To Learn">
<span>Learning To Learn</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/presentations.html title=Presentations>
<span>Presentations</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=http://robertu94.github.io/>Home</a></div>
<h1 class=post-title>
Learning to Learn: GDB
</h1>
<div class=post-meta>8 min&nbsp;·&nbsp;1670 words&nbsp;·&nbsp;Robert Underwood
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><nav id=TableOfContents>
<ul>
<li><a href=#how-to-get-started>How to get started</a></li>
<li><a href=#core-functionality>Core functionality</a>
<ul>
<li><a href=#examining-memory>Examining Memory</a></li>
<li><a href=#source-and-where-to-find-it>Source and where to find it</a></li>
<li><a href=#debugging-libraries>Debugging Libraries</a></li>
<li><a href=#multi-processthread>Multi Process/Thread</a></li>
</ul>
</li>
<li><a href=#advanced-ways-to-start-gdb>Advanced ways to start GDB</a>
<ul>
<li><a href=#core-dumps>Core dumps</a></li>
<li><a href=#connecting-to-a-running-process>Connecting to a running process</a></li>
<li><a href=#gdb-server>GDB Server</a></li>
</ul>
</li>
<li><a href=#other-advanced-features>Other Advanced Features</a>
<ul>
<li><a href=#gdb-scripting>GDB Scripting</a></li>
<li><a href=#python-extensions>Python Extensions</a></li>
</ul>
</li>
<li><a href=#where-to-learn-more>Where to learn more?</a></li>
<li><a href=#changelog>Changelog</a></li>
</ul>
</nav>
</div>
</details>
</div>
<div class=post-content><p>GDB is a powerful tool that is underutilized by most programmers that I&rsquo;ve met.
It can tell you the state of one or more running or crashed programs, and even manipulate the memory of a running process.
It is an invaluable tool for understanding what is going wrong with your programs.</p>
<h1 id=how-to-get-started>How to get started<a hidden class=anchor aria-hidden=true href=#how-to-get-started>#</a></h1>
<p>To get the most out of GDB you need to compile your program with debug information &ndash; metadata that describes the program source. If writing proprietary software, be careful who gets access to debug builds of your software, it embeds the entire source code of your application into the debugging information.</p>
<p>If using <code>gcc</code> or <code>clang</code>, you can get debugging information by simply adding <code>-g</code> to the compilation flags and recompiling. If using CMake, you can enable debugging information by using either <code>CMAKE_BUILD_TYPE=Debug</code> or <code>CMAKE_BUILD_TYPE=RelWithDebInfo</code> &ndash; similar options exist for other buildsystems and compilers.</p>
<p>Once you have a debug build you can run your program as <code>gdb --args ./path/to/program example arguments</code>. When the program crashes, type <code>bt</code> at the prompt, and you will get a trace of the stack at the time the program crashed, you can then type <code>info locals</code> to get a printout of all the local variables, and you can then type <code>dis</code> to see the assembely where the program crashed. If this was all GDB did it would be enormously helpful.</p>
<h1 id=core-functionality>Core functionality<a hidden class=anchor aria-hidden=true href=#core-functionality>#</a></h1>
<p>Here is some of the most valuable capabilities provided by GDB:</p>
<p><strong>Printing local variables</strong> you can print a local variable by calling <code>p variablename</code>. You can also print simple expressions such as <code>p var1+var2</code> or <code>p some_func(var1)</code>. You can print an array <code>a</code> like so <code>p a[0]@length</code>. C++ objects in the standard library have pretty printers so you get sane output for things like <code>std::vector</code> by calling <code>p v</code>.</p>
<p><strong>Breakpoints</strong> allow you stop execution of a program at a certain location. You can call <code>break some_func</code> to break on a function name and complete names with <code>tab</code>. For C++ which includes function overloads, you can break on specific template and overloads by <code>tab</code>bing out the specific implementation. You can also break at file locations <code>break foo.cc:30</code>. You can run until a breakpoint is hit by running <code>continue</code> or <code>run</code> to start for the first time. Breakpoints can also be conditional on boolean expressions <code>break foo.cc:30 if a==3</code> to break at line 30 of file <code>foo.cc</code> if and only if <code>a</code> is 3. Lastly, you can <code>break</code> at an individual instruction which is powerful when you don&rsquo;t have symbols</p>
<p>You can also break on C++ exceptions with <code>catch throw</code> and C signals with <code>catch signal</code>.</p>
<p><strong>Running commands at breakpoints</strong> After defining a breakpoint, you can provide a set of commands that will run after the breakpoint is hit. For example:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>break foo.cc:30
commands
print a
contine
end
</code></pre></div><p>Would print <code>a</code> and then <code>continue</code> automatically.</p>
<p><strong>Watch points</strong> in addition to breaking on a function location, you can also break when a variable is modified. When this has hardware support it is reasonably fast, but only supports a small number of bytes. You can watch expressions such as <code>watch left</code>.</p>
<p><strong>Iterative debugging (make)</strong> GDB allows you run <code>make</code> followed by <code>run</code> to rebuild and re-run. If you use <code>cmake</code> you can run <code>!cmake --build builddir -j 8</code> to run builds too.</p>
<p><strong>Stepping, navigating the stack</strong> GDB also allows you to single step and move up and down the stack with commands like <code>s</code> step into a function call, <code>n</code> go to the next program line, <code>ni</code> go to the next instruction, <code>up</code> go up the stack, <code>down</code> go down the stack, and <code>fin</code> to run until a function returns. However, these functions exist to supplement the functions described above instead of the primary means of using GDB.</p>
<h2 id=examining-memory>Examining Memory<a hidden class=anchor aria-hidden=true href=#examining-memory>#</a></h2>
<p><strong>Printing raw memory</strong> GDB allows you to print raw memory using commands like `x/8xg to print the next 64 bytes as hex. This can be useful to debug when something was overwritten or to debug without debug symbols.</p>
<h2 id=source-and-where-to-find-it>Source and where to find it<a hidden class=anchor aria-hidden=true href=#source-and-where-to-find-it>#</a></h2>
<p><strong>Types of debuginfo</strong> there are many kinds of debug info. On linux systems, the most common kind is <code>dwarf</code> (what you get with <code>-g</code>). Dwarf verbosity can be increased with GCC by using <code>-g3</code> which includes for example macro definitions in the source code.</p>
<p><strong>Stripping</strong> in addition to compiling with debug info the <code>strip</code> command allow removing this after the fact, this allows you to produce debug information and then re attach it later without having to ship it with every copy of the binary.</p>
<p><strong>Source directory (re-pathed)</strong> if you still have the source directory arround, you can tell GDB where to find it if it doesn&rsquo;t automatically. You can provide it with <code>symbol-file</code> and if the path needs to be re-written, you can use <code>set substitute-path</code> to provide rules to re-write file paths in symbol files.</p>
<p><strong>Debuginfod</strong> linux distributions such as Fedora and CentOS now provide debuginfod servers which provide debug symbols for system libraries. This can provide symbols when they aren&rsquo;t installed by default.</p>
<p><strong>Spack</strong> By default, spack compiles cmake projects with <code>RelWithDebInfo</code> which provides basic debugging symbols, however the source is not installed by default. By using spack envionments and <code>spack develop</code> it does the right thing, and you can get the source.</p>
<h2 id=debugging-libraries>Debugging Libraries<a hidden class=anchor aria-hidden=true href=#debugging-libraries>#</a></h2>
<p><strong>Listing what shared libraries are loaded</strong> sometimes you want to know what libraries where loaded. <code>info sharedlibrary</code> to get a list of them. I used this to detect a version mismatch between uses of two different zfp libraries that were both installed.</p>
<h2 id=multi-processthread>Multi Process/Thread<a hidden class=anchor aria-hidden=true href=#multi-processthread>#</a></h2>
<p>GDB provides abilities to debug multi-process and multi-thread programs as well as those that call <code>exec</code>. The <code>follow-fork</code> and <code>follow-exec</code> commands do what you would expect. You can use <code>catch fork</code> and <code>catch exec</code> to break on fork and exec.</p>
<p><strong>Non-stop mode and background commands</strong>** allows non-main threads to continue to run when the focused thread is stopped. This is essential in many cases for debugging multi-threaded programs. To debug multiple threads simultaneously you will often need to run commands in the background by appending the <code>&</code> character to them. You can re-forground a thread by usingthe <code>interrupt</code> command</p>
<h1 id=advanced-ways-to-start-gdb>Advanced ways to start GDB<a hidden class=anchor aria-hidden=true href=#advanced-ways-to-start-gdb>#</a></h1>
<p>In addition to starting a command under gdb, there are two other key ways to use GDB &ndash; core dumps and attaching to running processes.</p>
<h2 id=core-dumps>Core dumps<a hidden class=anchor aria-hidden=true href=#core-dumps>#</a></h2>
<p><strong>What is a core dump</strong> Core dumps are a copy of all registers and memory. These can be taken at any time, but are created automatically when a signal such as <code>sigsegv</code> terminates a process.</p>
<p><strong>Enabling core dumps</strong> if they are not enabled, there are a few key steps to enable them:
If you are using <code>systemd</code>, you can use <code>coredumpctl gdb</code> if you are a member of the <code>journald</code> group.
If you are not a member of <code>journald</code>, and your system uses <code>systemd</code>, you don&rsquo;t really have a way to enable core dumps without root privileges.
If you are not using <code>systemd</code>, the core gets written to the location specified by <code>kernel.core_pattern</code> sysctl.
Lastly, the process has to have a positive core dump limit which are defaulted by <code>/etc/security/limits.conf</code></p>
<p><strong>Using core dumps</strong> once you have a core file, you can debug a core file with <code>gdb -c ./path/to/core ./path/to/program</code> You can&rsquo;t use breakpoints, but you can inspect local variables and final stack information.</p>
<h2 id=connecting-to-a-running-process>Connecting to a running process<a hidden class=anchor aria-hidden=true href=#connecting-to-a-running-process>#</a></h2>
<p>Connecting GDB to a running process require privileges &ndash; namely <code>CAP_SYS_PTRACE</code> or <code>CAP_SYS_ADMIN</code> &ndash; to attach to a process. You also will need permissions (e.g., user or gropus) to access the running process. You can connect to a running process with <code>gdb -p $PID /path/to/command</code>.</p>
<h2 id=gdb-server>GDB Server<a hidden class=anchor aria-hidden=true href=#gdb-server>#</a></h2>
<p>Beyond basic uses of GDB to connect to remote processes, GDB can also attach to remote processes or embeded devices. I&rsquo;ve written a program called <a href=https://github.com/robertu94/mpigdb><code>mpigdb</code></a> that uses this functionality to debug MPI programs. To use this functionality start the program under <code>gdbserver</code> with a connection string and other flags you would otherwise pass to <code>gdb</code>. Once the GDB server is started, you can connect to a GDB server with <code>target remote</code>.</p>
<p>This functionality is also used for embedded devices. Lastly, GDB server functionality is also used with Valgrind&rsquo;s interactive memory sanitizer to get much more information about memory leaks at runtime.</p>
<h1 id=other-advanced-features>Other Advanced Features<a hidden class=anchor aria-hidden=true href=#other-advanced-features>#</a></h1>
<p>GDB has many more advanced features, and only so many of them can be covered here. Here are a few more of the ones that I find very useful</p>
<h2 id=gdb-scripting>GDB Scripting<a hidden class=anchor aria-hidden=true href=#gdb-scripting>#</a></h2>
<p>Beyond just running commands at breakpoints, you can put a set of commands in to a file to be executed when GDB starts by passing <code>-x ./path-to-script.gdb</code>.</p>
<p><strong>Settings you&rsquo;ll want to adjust</strong> To write effective scripts there are a few settings you will want to adjust:</p>
<ul>
<li>safe mode &ndash; what directories GDB can load scripts from</li>
<li>pagination &ndash; GDB pauses when pagniation happens so using it scripts often requires turning this off.</li>
<li>fork/exec/non-stop modes &ndash; set the fork and exec modes you need to be appropriate for your application</li>
</ul>
<p><strong>Setting variables</strong> often when writing scripts requires needing variables. GDB allows what are called convenience variables &ndash; variables which are not stored in the program&rsquo;s memory. These variables are prefixed with a <code>$</code> character and set with the <code>set</code> command.</p>
<h2 id=python-extensions>Python Extensions<a hidden class=anchor aria-hidden=true href=#python-extensions>#</a></h2>
<p>If GDB scripts in it&rsquo;s scripting language are too primitive, you can also write extension commands and pretty printers in Python. These are simple python classes that have access to most of the capabilities of GDB.</p>
<p>These functionalities have been used for capabilities like debugging Python modules with C extensions. For example when running a python program (assuming everything has been configured correctly), you can call <code>py-bt</code> to get the python strack trace in addition to the C/C++ backtrack allowing you to vastly improve your ability to debug things.</p>
<h1 id=where-to-learn-more>Where to learn more?<a hidden class=anchor aria-hidden=true href=#where-to-learn-more>#</a></h1>
<p>I&rsquo;ve just scratched the surface. There are many more powerful features that I haven&rsquo;t discussed such as reverse debugging, trace points, and more.</p>
<p>For more information see the <a href=https://sourceware.org/gdb/onlinedocs/gdb/>GDB documentation</a></p>
<p>I hope this helps!</p>
<h1 id=changelog>Changelog<a hidden class=anchor aria-hidden=true href=#changelog>#</a></h1>
<ul>
<li>2023-01-25 Created this document.</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=http://robertu94.github.io/tags/learning-to-learn.html>Learning to Learn</a></li>
<li><a href=http://robertu94.github.io/tags/programming.html>Programming</a></li>
<li><a href=http://robertu94.github.io/tags/c++.html>C++</a></li>
<li><a href=http://robertu94.github.io/tags/gdb.html>GDB</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2023 <a href=http://robertu94.github.io/>systems++</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>