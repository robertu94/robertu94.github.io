<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Spack on Polaris | systems++</title>
<meta name=keywords content>
<meta name=description content="tl;dr Put the following in your .bashrc
function use_build { # other ALCF machines if hostname -f | grep polaris &>/dev/null; then echo &#34;loading polaris spack&#34; module swap PrgEnv-nvhpc PrgEnv-gnu module load cudatoolkit-standalone source ${HOME}/git/spack-theta/share/spack/setup-env.sh export CRAYPE_LINK_TYPE=dynamic export clustername=polaris fi export SPACK_USER_CONFIG_PATH=&#34;$HOME/.spack/$clustername&#34; export SPACK_USER_CACHE_PATH=&#34;$SPACK_USER_CONFIG_PATH&#34; } Then run
mkdir -p ~/git git clone https://github.com/spack/spack git/spack-polaris git clone https://github.com/robertu94/spack_packages git/robertu94_packages git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages source ~/.bashrc use_build spack compiler find # for extra packages like libpressio and thallium spack repo add ~/git/robertu94_packages spack repo add ~/git/mochi-spack-packages First create packages.">
<meta name=author content="Robert Underwood">
<link rel=canonical href=http://robertu94.github.io/guides/polaris.html>
<meta name=google-site-verification content="G-9KQE44SX6K">
<link crossorigin=anonymous href=/assets/css/stylesheet.57f29198e62b3a8f07d37acaca0427bafb684416046b823f5a616bd858bb4af1.css integrity="sha256-V/KRmOYrOo8H03rKygQnuvtoRBYEa4I/WmFr2Fi7SvE=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.baa4f2053c75d0009e9309aae8f8a8959f5e0372e88f80cdf2951a9533d71ce2.js integrity="sha256-uqTyBTx10ACekwmq6PiolZ9eA3Loj4DN8pUalTPXHOI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://robertu94.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=http://robertu94.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=http://robertu94.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=http://robertu94.github.io/apple-touch-icon.png>
<link rel=mask-icon href=http://robertu94.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9KQE44SX6K"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-9KQE44SX6K',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Spack on Polaris">
<meta property="og:description" content="tl;dr Put the following in your .bashrc
function use_build { # other ALCF machines if hostname -f | grep polaris &>/dev/null; then echo &#34;loading polaris spack&#34; module swap PrgEnv-nvhpc PrgEnv-gnu module load cudatoolkit-standalone source ${HOME}/git/spack-theta/share/spack/setup-env.sh export CRAYPE_LINK_TYPE=dynamic export clustername=polaris fi export SPACK_USER_CONFIG_PATH=&#34;$HOME/.spack/$clustername&#34; export SPACK_USER_CACHE_PATH=&#34;$SPACK_USER_CONFIG_PATH&#34; } Then run
mkdir -p ~/git git clone https://github.com/spack/spack git/spack-polaris git clone https://github.com/robertu94/spack_packages git/robertu94_packages git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages source ~/.bashrc use_build spack compiler find # for extra packages like libpressio and thallium spack repo add ~/git/robertu94_packages spack repo add ~/git/mochi-spack-packages First create packages.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://robertu94.github.io/guides/polaris.html"><meta property="article:section" content="guides">
<meta property="article:published_time" content="2022-07-19T00:00:00+00:00">
<meta property="article:modified_time" content="2022-07-19T00:00:00+00:00"><meta property="og:site_name" content="Systems++">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Spack on Polaris">
<meta name=twitter:description content="tl;dr Put the following in your .bashrc
function use_build { # other ALCF machines if hostname -f | grep polaris &>/dev/null; then echo &#34;loading polaris spack&#34; module swap PrgEnv-nvhpc PrgEnv-gnu module load cudatoolkit-standalone source ${HOME}/git/spack-theta/share/spack/setup-env.sh export CRAYPE_LINK_TYPE=dynamic export clustername=polaris fi export SPACK_USER_CONFIG_PATH=&#34;$HOME/.spack/$clustername&#34; export SPACK_USER_CACHE_PATH=&#34;$SPACK_USER_CONFIG_PATH&#34; } Then run
mkdir -p ~/git git clone https://github.com/spack/spack git/spack-polaris git clone https://github.com/robertu94/spack_packages git/robertu94_packages git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages source ~/.bashrc use_build spack compiler find # for extra packages like libpressio and thallium spack repo add ~/git/robertu94_packages spack repo add ~/git/mochi-spack-packages First create packages.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Spack on Polaris","item":"http://robertu94.github.io/guides/polaris.html"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spack on Polaris","name":"Spack on Polaris","description":"tl;dr Put the following in your .bashrc\nfunction use_build { # other ALCF machines if hostname -f | grep polaris \u0026amp;\u0026gt;/dev/null; then echo \u0026#34;loading polaris spack\u0026#34; module swap PrgEnv-nvhpc PrgEnv-gnu module load cudatoolkit-standalone source ${HOME}/git/spack-theta/share/spack/setup-env.sh export CRAYPE_LINK_TYPE=dynamic export clustername=polaris fi export SPACK_USER_CONFIG_PATH=\u0026#34;$HOME/.spack/$clustername\u0026#34; export SPACK_USER_CACHE_PATH=\u0026#34;$SPACK_USER_CONFIG_PATH\u0026#34; } Then run\nmkdir -p ~/git git clone https://github.com/spack/spack git/spack-polaris git clone https://github.com/robertu94/spack_packages git/robertu94_packages git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages source ~/.bashrc use_build spack compiler find # for extra packages like libpressio and thallium spack repo add ~/git/robertu94_packages spack repo add ~/git/mochi-spack-packages First create packages.","keywords":[],"articleBody":"tl;dr Put the following in your .bashrc\nfunction use_build { # other ALCF machines if hostname -f | grep polaris \u0026/dev/null; then echo \"loading polaris spack\" module swap PrgEnv-nvhpc PrgEnv-gnu module load cudatoolkit-standalone source ${HOME}/git/spack-theta/share/spack/setup-env.sh export CRAYPE_LINK_TYPE=dynamic export clustername=polaris fi export SPACK_USER_CONFIG_PATH=\"$HOME/.spack/$clustername\" export SPACK_USER_CACHE_PATH=\"$SPACK_USER_CONFIG_PATH\" } Then run\nmkdir -p ~/git git clone https://github.com/spack/spack git/spack-polaris git clone https://github.com/robertu94/spack_packages git/robertu94_packages git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages source ~/.bashrc use_build spack compiler find # for extra packages like libpressio and thallium spack repo add ~/git/robertu94_packages spack repo add ~/git/mochi-spack-packages First create packages.yaml at ~/.spack/polaris/packages.yaml with:\npackages:all:providers:mpi:[cray-mpich]cuda:externals:- spec:cuda@12.0.0modules:[cudatoolkit-standalone/12.0.0]- spec:cuda@11.8.0modules:[cudatoolkit-standalone/11.8.0]- spec:cuda@11.7.1modules:[cudatoolkit-standalone/11.7.1]- spec:cuda@11.6.2modules:['cudatoolkit-standalone/11.6.2']- spec:cuda@11.4.4modules:[cudatoolkit-standalone/11.4.4]- spec:cuda@11.2.2modules:[cudatoolkit-standalone/11.2.2]buildable:Falselibfabric:externals:- spec:libfabric@1.11.0modules:['libfabric/1.11.0.4.125']buildable:Falsecray-mpich:externals:- spec:cray-mpich@8.1.16+wrappersmodules:['cray-mpich/8.1.16']buildable:Falseopenssl:externals:- spec:openssl@1.1.1dprefix:/usrbuildable:FalseAfter that create compilers.yaml at ~/.spack/polaris/cray/compilers.yaml with:\ncompilers:- compiler:spec:gcc@12.3.0 paths:cc:/usr/bin/gcc-12 cxx:/usr/bin/g++-12 f77:/usr/bin/gfortran-12 fc:/usr/bin/gfortran-12 flags:{}operating_system:sles15 target:x86_64 modules:['libfabric/1.15.2.0','cray-mpich/8.1.28']environment:{}extra_rpaths:[]And now spack should work. On your next login, just call use_build to reload spack.\nFor the longer version see the guide on [configuring spack]({% link _guides/spack.markdown %})\nWhat makes this machine special?  We use openssl and mpi from the system to avoid configuring them We load a new compiler and programming environment because the default is older. Spack shares a home filesystem with other machines like cooley these machines are completely different hardware wise and use different module systems. The load function loads a copy of spack specifically for Cooley and uses a separate spark instance for other machines. We use spack’s SPACK_USER_CONFIG_PATH variable to keep these cleanly separate. Polaris is a cray machine, so needs some cray special sauce like the PrgEnv-gnu to behave more sanely. However, unlike theta it uses CRAYPE_LINK_TYPE=dynamic as the default behavior so we don’t need to set it here. As of writing, Polaris uses slingshot 10 and will be updated to Slingshot 11 in Fall 2022 While this should not change the configuration used here, it may change the connection strings for certain applications using mochi/margo based services from using from verbs;ofi_rxm to cxi  Changelog  2022-08-29 created this document  ","wordCount":"310","inLanguage":"en","datePublished":"2022-07-19T00:00:00Z","dateModified":"2022-07-19T00:00:00Z","author":{"@type":"Person","name":"Robert Underwood"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://robertu94.github.io/guides/polaris.html"},"publisher":{"@type":"Organization","name":"systems++","logo":{"@type":"ImageObject","url":"http://robertu94.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=http://robertu94.github.io/ accesskey=h title="systems++ (Alt + H)">systems++</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=http://robertu94.github.io/about.html title="About Me">
<span>About Me</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/guides.html title=Guides>
<span>Guides</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/learning.html title="Learning To Learn">
<span>Learning To Learn</span>
</a>
</li>
<li>
<a href=http://robertu94.github.io/presentations.html title=Presentations>
<span>Presentations</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=http://robertu94.github.io/>Home</a></div>
<h1 class=post-title>
Spack on Polaris
</h1>
<div class=post-meta><span title="2022-07-19 00:00:00 +0000 UTC">July 19, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;310 words&nbsp;·&nbsp;Robert Underwood
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><nav id=TableOfContents>
<ul>
<li><a href=#tldr>tl;dr</a></li>
<li><a href=#what-makes-this-machine-special>What makes this machine special?</a></li>
<li><a href=#changelog>Changelog</a></li>
</ul>
</nav>
</div>
</details>
</div>
<div class=post-content><h1 id=tldr>tl;dr<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h1>
<p>Put the following in your <code>.bashrc</code></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=k>function</span> use_build <span class=o>{</span>
    <span class=c1># other ALCF machines</span>
    <span class=k>if</span> hostname -f  <span class=p>|</span> grep polaris <span class=p>&amp;</span>&gt;/dev/null<span class=p>;</span> <span class=k>then</span>
       <span class=nb>echo</span> <span class=s2>&#34;loading polaris spack&#34;</span>
       module swap PrgEnv-nvhpc PrgEnv-gnu
       module load cudatoolkit-standalone
       <span class=nb>source</span> <span class=si>${</span><span class=nv>HOME</span><span class=si>}</span>/git/spack-theta/share/spack/setup-env.sh
       <span class=nb>export</span> <span class=nv>CRAYPE_LINK_TYPE</span><span class=o>=</span>dynamic
       <span class=nb>export</span> <span class=nv>clustername</span><span class=o>=</span>polaris
     <span class=k>fi</span>
    <span class=nb>export</span> <span class=nv>SPACK_USER_CONFIG_PATH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.spack/</span><span class=nv>$clustername</span><span class=s2>&#34;</span>
    <span class=nb>export</span> <span class=nv>SPACK_USER_CACHE_PATH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$SPACK_USER_CONFIG_PATH</span><span class=s2>&#34;</span>
<span class=o>}</span>
</code></pre></div><p>Then run</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>mkdir -p ~/git
git clone https://github.com/spack/spack git/spack-polaris
git clone https://github.com/robertu94/spack_packages git/robertu94_packages
git clone https://github.com/mochi-hpc/mochi-spack-packages git/mochi-spack-packages
<span class=nb>source</span> ~/.bashrc
use_build
spack compiler find

<span class=c1># for extra packages like libpressio and thallium</span>
spack repo add ~/git/robertu94_packages
spack repo add ~/git/mochi-spack-packages
</code></pre></div><p>First create <code>packages.yaml</code> at <code>~/.spack/polaris/packages.yaml</code> with:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nt>packages</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>all</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>providers</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>mpi</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cray-mpich]</span><span class=w>
</span><span class=w>  </span><span class=nt>cuda</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>externals</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@12.0.0</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cudatoolkit-standalone/12.0.0]</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@11.8.0</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cudatoolkit-standalone/11.8.0]</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@11.7.1</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cudatoolkit-standalone/11.7.1]</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@11.6.2</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;cudatoolkit-standalone/11.6.2&#39;</span><span class=p>]</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@11.4.4</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cudatoolkit-standalone/11.4.4]</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cuda@11.2.2</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cudatoolkit-standalone/11.2.2]</span><span class=w>
</span><span class=w>    </span><span class=nt>buildable</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span><span class=w>  </span><span class=nt>libfabric</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>externals</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>libfabric@1.11.0</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;libfabric/1.11.0.4.125&#39;</span><span class=p>]</span><span class=w>
</span><span class=w>    </span><span class=nt>buildable</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span><span class=w>  </span><span class=nt>cray-mpich</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>externals</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>cray-mpich@8.1.16+wrappers</span><span class=w>
</span><span class=w>        </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;cray-mpich/8.1.16&#39;</span><span class=p>]</span><span class=w>
</span><span class=w>    </span><span class=nt>buildable</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span><span class=w>  </span><span class=nt>openssl</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>externals</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>openssl@1.1.1d</span><span class=w>
</span><span class=w>      </span><span class=nt>prefix</span><span class=p>:</span><span class=w> </span><span class=l>/usr</span><span class=w>
</span><span class=w>    </span><span class=nt>buildable</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span></code></pre></div><p>After that create <code>compilers.yaml</code> at <code>~/.spack/polaris/cray/compilers.yaml</code> with:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nt>compilers</span><span class=p>:</span><span class=w>                                                                                                                                
</span><span class=w></span>- <span class=nt>compiler</span><span class=p>:</span><span class=w>                                                                                                                               
</span><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>gcc@12.3.0                                                                                                                      </span><span class=w>
</span><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>                                                                                                                                
</span><span class=w>      </span><span class=nt>cc</span><span class=p>:</span><span class=w> </span><span class=l>/usr/bin/gcc-12                                                                                                                 </span><span class=w>
</span><span class=w>      </span><span class=nt>cxx</span><span class=p>:</span><span class=w> </span><span class=l>/usr/bin/g++-12                                                                                                                </span><span class=w>
</span><span class=w>      </span><span class=nt>f77</span><span class=p>:</span><span class=w> </span><span class=l>/usr/bin/gfortran-12                                                                                                           </span><span class=w>
</span><span class=w>      </span><span class=nt>fc</span><span class=p>:</span><span class=w> </span><span class=l>/usr/bin/gfortran-12                                                                                                            </span><span class=w>
</span><span class=w>    </span><span class=nt>flags</span><span class=p>:</span><span class=w> </span>{}<span class=w>                                                                                                                             
</span><span class=w>    </span><span class=nt>operating_system</span><span class=p>:</span><span class=w> </span><span class=l>sles15                                                                                                              </span><span class=w>
</span><span class=w>    </span><span class=nt>target</span><span class=p>:</span><span class=w> </span><span class=l>x86_64                                                                                                                        </span><span class=w>
</span><span class=w>    </span><span class=nt>modules</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;libfabric/1.15.2.0&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;cray-mpich/8.1.28&#39;</span><span class=p>]</span><span class=w>                                                                                  
</span><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span>{}<span class=w>                                                                                                                       
</span><span class=w>    </span><span class=nt>extra_rpaths</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=w>
</span></code></pre></div><p>And now spack should work. On your next login, just call <code>use_build</code> to reload spack.</p>
<p>For the longer version see the guide on [configuring spack]({% link _guides/spack.markdown %})</p>
<h1 id=what-makes-this-machine-special>What makes this machine special?<a hidden class=anchor aria-hidden=true href=#what-makes-this-machine-special>#</a></h1>
<ol>
<li>We use openssl and mpi from the system to avoid configuring them</li>
<li>We load a new compiler and programming environment because the default is older.</li>
<li>Spack shares a home filesystem with other machines like <code>cooley</code> these
machines are completely different hardware wise and use different module
systems. The load function loads a copy of spack specifically for Cooley and uses
a separate spark instance for other machines. We use spack&rsquo;s
<code>SPACK_USER_CONFIG_PATH</code> variable to keep these cleanly separate.</li>
<li>Polaris is a cray machine, so needs some cray special sauce like the
PrgEnv-gnu to behave more sanely. However, unlike theta it uses
<code>CRAYPE_LINK_TYPE=dynamic</code> as the default behavior so we don&rsquo;t need to set it here.</li>
<li>As of writing, Polaris uses slingshot 10 and will be updated to Slingshot 11 in Fall 2022
While this should not change the configuration used here, it may change the connection strings
for certain applications using mochi/margo based services from using from <code>verbs;ofi_rxm</code> to <code>cxi</code></li>
</ol>
<h1 id=changelog>Changelog<a hidden class=anchor aria-hidden=true href=#changelog>#</a></h1>
<ul>
<li>2022-08-29 created this document</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2025 <a href=http://robertu94.github.io/>systems++</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>